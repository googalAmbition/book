# Docker volumes
当我们在使用docker容器的时候，会产生一系列的数据文件，这些数据文件在我们删除docker容器时是
会消失的，但是其中产生的部分内容我们是希望能够把它给保存起来另作用途的，Docker将应用与运行
环境打包成容器发布，我们希望在运行过程钟产生的部分数据是可以持久化的的，而且容器之间我们希
望能够实现数据共享。

通俗地来说，docker容器数据卷可以看成使我们生活中常用的u盘，它存在于一个或多个的容器中，由
docker挂载到容器，但不属于联合文件系统，Docker不会在容器删除时删除其挂载的数据卷。

特点：
1. 数据卷可以在容器之间共享或重用数据
2. 数据卷中的更改可以立即生效
3. 数据卷中的更改不会包含在镜像的更新中
4. 数据卷默认会一直存在，即使容器被删除
5. 数据卷的生命周期一直持续到没有容器使用它为止

容器中的管理数据主要有两种方式：
- 数据卷：Data Volumes 容器内数据直接映射到本地主机环境 
- 数据卷容器：Data Volume Containers 使用特定容器维护数据卷

**cp命令**
当然还有最原始的copy方式，这个也是管理数据的方式，但是基本不会用到。
docker cp :用于容器与主机之间的数据拷贝。

**语法**
```shell
# 宿主机文件复制到容器内
docker cp [OPTIONS] SRC_PATH CONTAINER:DEST_PATH
# 容器内文件复制到宿主机
docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH
```
**常用参数**
- `-L `:保持源目标中的链接

## 数据卷
数据卷(Data Volumes)是一个可供一个或多个容器使用的特殊目录，它将主机操作系统目录直接映射进容器。

**注意事项**
- 挂载数据卷，最好是通过run而非create/start创建启动容器，create/start命令创建启动容器
后，再挂载数据卷相当麻烦，要修改很多配置文件，但并非不可以。
- docker官网推荐尽量进行目录挂载，不要进行文件挂载

**数据卷类型**

有三种数据卷类型：
1. 宿主机数据卷：直接在宿主机的文件系统中但是容器可以访问（bind mount）
2. 命名的数据卷：磁盘上Docker管理的数据卷，但是这个卷有个名字。
3. 匿名数据卷：磁盘上Docker管理的数据卷，因为没有名字想要找到不容易，Docker来管理这些文
   件。

数据卷其实都在（如果没有网络文件系统等情况下）宿主机文件系统里面的，只是第一种是在宿主机内
的特定目录下，而后两种则在docker管理的目录下，这个目录一般是 /var/lib/docker/volumes/
推荐大家使用 宿主机数据卷 方式持久化数据

**宿主机数据卷**

bind mounts：容器内的数据被存放到宿主机文件系统的任意位置，甚至存放到一些重要的系统目录或
文件中。除了docker之外的进程也可以任意对他们进行修改。

当使用bind mounts时，宿主机的目录或文件被挂载到容器中。容器将按照挂载目录或文件的绝对路径
来使用或修改宿主机的数据。宿主机中的目录或文件不需要预先存在，在需要的使用会自动创建。

使用bind mounts在性能上是非常好的，但这依赖于宿主机有一个目录妥善结构化的文件系统。

使用bind mounts的容器可以在通过容器内部的进程对主机文件系统进行修改，包括创建，修改和删除
重要的系统文件和目录，这个功能虽然很强大，但显然也会造成安全方面的影响，包括影响到宿主机上
Docker以外的进程

**数据覆盖问题**

- 如果挂载一个空的数据卷到容器中的一个非空目录中，那么这个目录下的文件会被复制到数据卷中
- 如果挂载一个非空的数据卷到容器中的一个目录中，那么容器中的目录会显示数据卷中的数据。如
果原来容器中的目录有数据，那么原始数据会被隐藏掉

**语法**

```
docker run -v /宿主机绝对路径目录:/容器内目录 镜像名
```
